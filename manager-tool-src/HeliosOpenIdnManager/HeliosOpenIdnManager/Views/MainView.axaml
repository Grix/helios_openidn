<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:HeliosOpenIdnManager.ViewModels"
             xmlns:local="clr-namespace:HeliosOpenIdnManager"
			 xmlns:materialIcons="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia"
             mc:Ignorable="d" d:DesignWidth="1100" d:DesignHeight="750" MinWidth="1000"
             x:Class="HeliosOpenIdnManager.Views.MainView"
             x:DataType="vm:MainViewModel">
	<Design.DataContext>
		<!-- This only sets the DataContext for the previewer in an IDE,
         to set the actual DataContext for runtime, set the DataContext property in code (look at App.axaml.cs) -->
		<vm:MainViewModel />
	</Design.DataContext>

	<Grid ColumnDefinitions="300,*">
		
		<Grid Grid.RowSpan="3" Background="LightGray" RowDefinitions="250, *, Auto, 60">

			<StackPanel Grid.Column="1" Spacing="12" Margin="15,20,15,15">
				
				<!-- SELECTED SERVER INFO -->

				<TextBlock Margin="5,0,0,0" Text="{Binding SelectedServerTitle, StringFormat='Selected device:&#x0a; {0}'}" MinHeight="30" />
				<TextBlock Margin="5,0,0,0" IsVisible="{Binding HasSelectedServer}" Text="{Binding ServicesListString, StringFormat='Outputs: {0}'}" MinHeight="60"/>
				<Grid IsVisible="{Binding !HasSelectedServer}" MinHeight="60"></Grid>

				<Button Command="{Binding RestartServerCommand}" IsEnabled="{Binding HasSelectedServer}" Background="LightBlue"  Content=" Restart device " ToolTip.Tip="Reboots the device. This will apply the new configuration or software update if one was uploaded. "></Button>

				<Separator></Separator>

				
				<!-- LIST OF SERVERS -->

				<StackPanel Grid.Row="0" Spacing="10" Margin="15,0,15,0" HorizontalAlignment="Center">
					<TextBlock Text="Device List" FontWeight="SemiBold" HorizontalAlignment="Center"/>

					<Button Grid.Row="2" Command="{Binding ScanForServersCommand}" Background="White" Margin="5,5" ToolTip.ShowDelay="0" ToolTip.Tip="Click to scan the network for Helios network devices.">
						<StackPanel Orientation="Horizontal">
							<materialIcons:MaterialIcon Kind="Radar" VerticalAlignment="Center" Foreground="Green" Height="29" Width="29" HorizontalAlignment="Left"/>
							<TextBlock Text=" Scan available servers" VerticalAlignment="Center"></TextBlock>
						</StackPanel>
					</Button>

				</StackPanel>
				
			</StackPanel>

			<ScrollViewer Grid.Row="1" Margin="15,0,15,5">
				<ListBox ItemsSource="{Binding Servers}" SelectionMode="Single" SelectedIndex="{Binding SelectedServerIndex}">
					<ListBox.ItemTemplate>
						<DataTemplate>
							<TextBlock Text="{Binding Title}" VerticalAlignment="Center" Margin="20,0,0,0"></TextBlock>
						</DataTemplate>
					</ListBox.ItemTemplate>
				</ListBox>
			</ScrollViewer>

			<TextBlock Grid.Row="2" Margin="20, 5, 0, 0" Foreground="Red" TextWrapping="Wrap" IsVisible="{Binding !!ErrorMessage}" Text="{Binding ErrorMessage, StringFormat='Error occured: &#x0a;{0}'}"/>
			
			<Button Grid.Row="3" Command="{Binding OpenManagerHelpPageCommand}" Background="Transparent" FontSize="22" Margin="5" ToolTip.ShowDelay="0" ToolTip.Tip="Open help page.">
				<StackPanel Orientation="Horizontal">
					<materialIcons:MaterialIcon Kind="QuestionMarkCircle" VerticalAlignment="Center" Foreground="MediumPurple" Height="29" Width="29" HorizontalAlignment="Left"/>
					<TextBlock Text=" Help" VerticalAlignment="Center"></TextBlock>
				</StackPanel>
			</Button>
			

		</Grid>

		<!-- SELECTED SERVER CONFIG/CONTROL -->

		<TabControl Grid.Column="1">
			
			<TabItem FontSize="20">
				<TabItem.Header>
					<StackPanel Orientation="Horizontal">
						<materialIcons:MaterialIcon Kind="Settings" VerticalAlignment="Center" Foreground="Gray" Height="25" Width="25" HorizontalAlignment="Left"/>
						<TextBlock Text=" Settings" VerticalAlignment="Center"></TextBlock>
					</StackPanel>
				</TabItem.Header>
					<Grid Margin="0,0,20,0" RowDefinitions="50,*,70">

						<StackPanel Grid.Row="0" Margin="0, 15, 0, 0" Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="20">
							<Button Command="{Binding LoadCurrentConfigCommand}" IsEnabled="{Binding HasSelectedServer}" ToolTip.Tip="Fills out the fields below with the existing configuration of the selected device.">
								<StackPanel Orientation="Horizontal">
									<materialIcons:MaterialIcon Kind="Refresh" VerticalAlignment="Center" Foreground="Green" Height="20" Width="20" HorizontalAlignment="Left"/>
									<TextBlock Text=" Load active config from device" VerticalAlignment="Center"></TextBlock>
								</StackPanel>
							</Button>
							<Button Command="{Binding LoadDefaultConfigCommand}" ToolTip.Tip="Fills out the fields below with the default configuration.">
								<StackPanel Orientation="Horizontal">
									<materialIcons:MaterialIcon Kind="SettingsBackupRestore" VerticalAlignment="Center" Foreground="Green" Height="20" Width="20" HorizontalAlignment="Left"/>
									<TextBlock Text=" Load default config" VerticalAlignment="Center"></TextBlock>
								</StackPanel>
							</Button>
						</StackPanel>
					
						<ScrollViewer Grid.Row="1" Padding="5,0,25,10">
							<StackPanel Spacing="2">

								<TextBlock Margin="5,25,0,5" HorizontalAlignment="Left" Text="Network" MinWidth="140" FontWeight="Bold"/>
								<DockPanel Margin="5,0,0,0">
									<TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="Ethernet IP Address:" MinWidth="140"/>
									<StackPanel>
										<CheckBox Margin="20,0" Content="Auto (DHCP)" IsChecked="{Binding EthernetIsDhcp}"/>
										<TextBox IsVisible="{Binding !EthernetIsDhcp}" Text="{Binding EthernetIpAddress}" Watermark="Unchanged" Margin="10,0,0,0" MinWidth="150" ToolTip.Tip="Here you can enter a static IP Address for the Ethernet port on the selected device. You can use CIDR notation to specify subnet, and you can configure multiple addresses by separating them with a space."></TextBox>
									</StackPanel>
								</DockPanel>
								<TextBlock IsVisible="{Binding EthernetIpAddressHasWarning}" Text="⚠ This IP Address does not appear to be valid" Foreground="Red"/>
										
								<Grid ColumnDefinitions="400,*" MinHeight="40" Margin="5,10">
									<StackPanel Grid.Column="0">
										<StackPanel Orientation="Horizontal" Background="#EEEEEE">
											<TextBlock VerticalAlignment="Center" Margin="5,0,0,0" Text="Enable WiFi:"/>
											<CheckBox IsChecked="{Binding WifiIsEnabled}" Margin="10,0,10,0" ></CheckBox>
											<materialIcons:MaterialIcon IsVisible="{Binding WifiIsEnabled}" Kind="Warning" VerticalAlignment="Center" Foreground="DarkOrange" Height="22" Width="22" HorizontalAlignment="Left"/>
											<TextBlock Margin="2,0,5,0" IsVisible="{Binding WifiIsEnabled}" Text="WiFi streaming can be unstable" VerticalAlignment="Center" Foreground="#BF8000"  />
										</StackPanel>
										<StackPanel Spacing="8" IsVisible="{Binding WifiIsEnabled}">
											<Grid>
												<DockPanel>
													<TextBlock Margin="10,0,0,0" VerticalAlignment="Center" Text="WiFi IP Address:" MinWidth="140"/>
													<StackPanel>
														<CheckBox Margin="20,0" Content="Auto (DHCP)" IsChecked="{Binding WifiIsDhcp}"/>
														<TextBox IsVisible="{Binding !WifiIsDhcp}" Text="{Binding WifiIpAddress}" Watermark="WiFi unchanged" Margin="10,0,0,0" MinWidth="150" ToolTip.Tip="Here you can enter a static IP Address for the WiFi interface on the selected device. You can use CIDR notation to specify subnet, and you can configure multiple addresses by separating them with a space."></TextBox>
													</StackPanel>
												</DockPanel>
											</Grid>
											<TextBlock Margin="0,0,0,0" IsVisible="{Binding WifiIpAddressHasWarning}" Text="⚠ This IP Address does not appear to be valid" Foreground="Red"/>
											<DockPanel Background="#EEEEEE" ToolTip.Tip="The password for the WiFi network. Leave blank if the network is open and there is no password.">
												<TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="WiFi Password:" MinWidth="120"/>
												<TextBox Text="{Binding WifiPassword}" Watermark="No password" PasswordChar="*" Margin="10,0,0,0" MinWidth="170" ></TextBox>
											</DockPanel>
											<DockPanel ToolTip.Tip="Here you can enter the name of the wireless network to connect to. You can also click the 'Scan nearby WiFi networks' button below to see what networks are available at the moment, and click one of them to fill this field in.">
												<TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="WiFi name (SSID):" MinWidth="120"/>
												<TextBox Text="{Binding WifiSsid}" Margin="10,0,0,0" Watermark="WiFi unchanged" MinWidth="170"></TextBox>
											</DockPanel>
										</StackPanel>
									</StackPanel>
									<StackPanel Grid.Column="1" IsVisible="{Binding WifiIsEnabled}" Margin="15,0,0,0">
										<Button Content="Scan nearby WiFi networks" IsEnabled="{Binding HasSelectedServer}" Command="{Binding ScanWifiNetworksCommand}"/>

										<ScrollViewer Grid.Row="1" MinHeight="100" Margin="0,5,0,0" >
											<ListBox ItemsSource="{Binding WifiNetworks}" SelectionMode="Single" SelectedIndex="{Binding SelectedWifiNetworkIndex}">
												<ListBox.ItemTemplate>
													<DataTemplate>
														<TextBlock Text="{Binding}" Margin="0,0,0,0"></TextBlock>
													</DataTemplate>
												</ListBox.ItemTemplate>
											</ListBox>
										</ScrollViewer>
									</StackPanel>
								</Grid>
											
								<TextBlock Margin="5,5,0,5" HorizontalAlignment="Left" Text="General" MinWidth="140" FontWeight="Bold"/>
								<DockPanel Margin="5,0,0,0" ToolTip.Tip="Here you can replace the default IDN hostname ('OpenIDN') of the selected device.">
									<TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="Device name:" MinWidth="300"/>
									<TextBox Text="{Binding NewServerName}" Watermark="Unchanged" Margin="10,0,0,0" MinWidth="170"></TextBox>
								</DockPanel>
								<DockPanel Margin="5,1,0,0" Background="#EEEEEE" ToolTip.Tip="This is the length of the output buffer in milliseconds. A lower value means less output latency, making the output more responsive, however it can also lead to unstable output with small pauses, especially in bad network conditions.">
									<TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="Output buffer length (latency) in ms:" MinWidth="300"/>
									<TextBox BorderThickness="1" Height="32" Text="{Binding BufferLengthMs}" Margin="10,0,0,0" MinWidth="100" ></TextBox>
								</DockPanel>

								<Grid Margin="5,15,0,5" ColumnDefinitions="*,40,*">
									<StackPanel Grid.Column="0" Spacing="3">
										<TextBlock HorizontalAlignment="Right" Text="Mode priority" MinWidth="140" FontWeight="Bold"/>
										<DockPanel ToolTip.Tip="In case multiple modes are active simultaneously, only the mode with the highest priority gets to control the laser output. The modes with lower priority need to wait for the other modes to stop their output before they can themselves start outputting.">
											<TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="Network stream (IDN):" MinWidth="120"/>
											<ComboBox Margin="10,0,10,0" SelectedIndex="{Binding NetworkModePriority}" Width="150" HorizontalAlignment="Right">
												<ComboBox.Items>
													<ComboBoxItem>Disable</ComboBoxItem>
													<ComboBoxItem>1</ComboBoxItem>
													<ComboBoxItem>2</ComboBoxItem>
													<ComboBoxItem>3</ComboBoxItem>
													<ComboBoxItem>4</ComboBoxItem>
												</ComboBox.Items>
											</ComboBox>
										</DockPanel>
										<DockPanel Background="#EEEEEE" ToolTip.Tip="In case multiple modes are active simultaneously, only the mode with the highest priority gets to control the laser output. The modes with lower priority need to wait for the other modes to stop their output before they can themselves start outputting.">
											<TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="USB stream:" MinWidth="120"/>
											<ComboBox Margin="10,0,10,0" SelectedIndex="{Binding UsbModePriority}" Width="150" HorizontalAlignment="Right">
												<ComboBox.Items>
													<ComboBoxItem>Disable</ComboBoxItem>
													<ComboBoxItem>1</ComboBoxItem>
													<ComboBoxItem>2</ComboBoxItem>
													<ComboBoxItem>3</ComboBoxItem>
													<ComboBoxItem>4</ComboBoxItem>
												</ComboBox.Items>
											</ComboBox>
										</DockPanel>
									</StackPanel>
									<StackPanel Grid.Column="2" Spacing="3">
										<TextBlock HorizontalAlignment="Right" Text="Mode priority" MinWidth="140" FontWeight="Bold"/>
										<DockPanel ToolTip.Tip="In case multiple modes are active simultaneously, only the mode with the highest priority gets to control the laser output. The modes with lower priority need to wait for the other modes to stop their output before they can themselves start outputting.">
											<TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="DMX (Art-Net, sACN etc):" MinWidth="120"/>
											<ComboBox Margin="10,0,10,0" SelectedIndex="{Binding DmxModePriority}" Width="150" HorizontalAlignment="Right">
												<ComboBox.Items>
													<ComboBoxItem>Disable</ComboBoxItem>
													<ComboBoxItem>1</ComboBoxItem>
													<ComboBoxItem>2</ComboBoxItem>
													<ComboBoxItem>3</ComboBoxItem>
													<ComboBoxItem>4</ComboBoxItem>
												</ComboBox.Items>
											</ComboBox>
										</DockPanel>
										<DockPanel Background="#EEEEEE" ToolTip.Tip="In case multiple modes are active simultaneously, only the mode with the highest priority gets to control the laser output. The modes with lower priority need to wait for the other modes to stop their output before they can themselves start outputting.">
											<TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="File player:" MinWidth="120"/>
											<ComboBox Margin="10,0,10,0" SelectedIndex="{Binding FileModePriority}" Width="150" HorizontalAlignment="Right">
												<ComboBox.Items>
													<ComboBoxItem>Disable</ComboBoxItem>
													<ComboBoxItem>1</ComboBoxItem>
													<ComboBoxItem>2</ComboBoxItem>
													<ComboBoxItem>3</ComboBoxItem>
													<ComboBoxItem>4</ComboBoxItem>
												</ComboBox.Items>
											</ComboBox>
										</DockPanel>
									</StackPanel>
								</Grid>

								<TextBlock Margin="5,25,0,5" HorizontalAlignment="Left" Text="File player" MinWidth="140" FontWeight="Bold"/>
								<DockPanel>
									<DockPanel Margin="0,0,0,5" MinWidth="110">
										<TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="Autoplay" />
										<CheckBox IsChecked="{Binding FilePlayerAutoplay}" BorderThickness="1" Height="32" HorizontalAlignment="Left" Margin="10,0,0,0"></CheckBox>
										<materialIcons:MaterialIcon IsVisible="{Binding FilePlayerAutoplay}" Kind="Warning" VerticalAlignment="Center" Foreground="DarkOrange" Height="22" Width="22" HorizontalAlignment="Left"/>
										<TextBlock Margin="2,0,5,0" IsVisible="{Binding FilePlayerAutoplay}" Text="Laser will turn on automatically" VerticalAlignment="Center" Foreground="#BF8000"  />
									</DockPanel>
									<DockPanel Margin="15,0,0,5" DockPanel.Dock="Right" HorizontalAlignment="Left" MinWidth="400" >
										<TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="When file finishes:" />
										<ComboBox Margin="10,0,0,0" SelectedIndex="{Binding FilePlayerModeIndex}" MinWidth="210" HorizontalAlignment="Stretch">
											<ComboBox.Items>
												<ComboBoxItem Tag="next">
													<StackPanel Orientation="Horizontal">
														<materialIcons:MaterialIcon Kind="SkipNext" VerticalAlignment="Center" Height="18" Width="18" HorizontalAlignment="Left"/>
														<TextBlock Text=" Play next (alphabetically)"/>
													</StackPanel>
												</ComboBoxItem>
												<ComboBoxItem Tag="shuffle">
													<StackPanel Orientation="Horizontal">
														<materialIcons:MaterialIcon Kind="Shuffle" VerticalAlignment="Center" Height="18" Width="18" HorizontalAlignment="Left"/>
														<TextBlock Text=" Play next (random shuffle)"/>
													</StackPanel>
												</ComboBoxItem>
												<ComboBoxItem Tag="once">
													<StackPanel Orientation="Horizontal">
														<materialIcons:MaterialIcon Kind="Stop" VerticalAlignment="Center" Height="18" Width="18" HorizontalAlignment="Left"/>
														<TextBlock Text=" Stop"/>
													</StackPanel>
												</ComboBoxItem>
												<ComboBoxItem Tag="repeat">
													<StackPanel Orientation="Horizontal">
														<materialIcons:MaterialIcon Kind="Repeat" VerticalAlignment="Center" Height="18" Width="18" HorizontalAlignment="Left"/>
														<TextBlock Text=" Repeat same file"/>
													</StackPanel>
												</ComboBoxItem>
											</ComboBox.Items>
										</ComboBox>
									</DockPanel>
								</DockPanel>
								<DockPanel Background="#EEEEEE" >
									<TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="Starting file:" MinWidth="120"/>
									<AutoCompleteBox BorderThickness="1" Height="32" Text="{Binding FilePlayerStartingFilename}" ItemsSource="{Binding Programs}" ValueMemberBinding="{Binding Name, x:DataType=vm:ProgramViewModel}" Watermark="Random" FilterMode="Contains" Margin="10,0,0,0" MinWidth="150" ToolTip.Tip="If file player autoplay is enabled, this is the file that starts playing when the device powers up. If left blank, the starting file is randomized."></AutoCompleteBox>
								</DockPanel>

								<TextBlock Margin="5,25,0,5" HorizontalAlignment="Left" Text="DMX" MinWidth="140" FontWeight="Bold"/>
								<Button Command="{Binding OpenDmxWebsiteCommand}" IsEnabled="{Binding HasSelectedServer}"  Content=" Open advanced DMX device settings " ToolTip.Tip="Open website with advanced DMX device settings." Margin="0,0,0,30"></Button>


							</StackPanel>
					</ScrollViewer>

							
					<StackPanel Grid.Row="2" Spacing="5" HorizontalAlignment="Center" Orientation="Horizontal" Margin="0,10,0,10">
						<Button IsEnabled="{Binding HasSelectedServer}" Background="LightGreen" ToolTip.Tip="Sends the configuration above to the selected device over the network. Once this is complete, you need to restart the device for the settings to take effect." Click="SaveConfigButton_Click">
							<StackPanel Orientation="Horizontal">
								<materialIcons:MaterialIcon Kind="Floppy" VerticalAlignment="Center" Foreground="Black" Height="22" Width="22" HorizontalAlignment="Left"/>
								<TextBlock Text=" Save/upload config" VerticalAlignment="Center"></TextBlock>
							</StackPanel>
						</Button>
						<Button Click="ExportConfigButton_Click" Background="Tan" Margin="50,0,0,0" ToolTip.Tip="Exports the configuration above to a settings.ini file. This file can be used to apply settings to an offline Helios OpenIDN device. To do this: Place the file settings.ini on a USB drive. Plug the USB drive into the device. Plug the power cable out and back in to reboot the device. The device should power up with the new settings. NB: The startup process could take up to a full minute.">
							<StackPanel Orientation="Horizontal">
								<materialIcons:MaterialIcon Kind="File" VerticalAlignment="Center" Foreground="Black" Height="22" Width="22" HorizontalAlignment="Left"/>
								<TextBlock Text=" Export config to file" VerticalAlignment="Center"></TextBlock>
							</StackPanel>
						</Button>
					</StackPanel>
						
				</Grid>
				
			</TabItem>

			<!-- FILE MANAGER -->

			<TabItem FontSize="20">
				<TabItem.Header>
					<StackPanel Orientation="Horizontal">
						<materialIcons:MaterialIcon Kind="Folder" VerticalAlignment="Center" Foreground="Gray" Height="25" Width="25" HorizontalAlignment="Left"/>
						<TextBlock Text=" File manager" VerticalAlignment="Center"></TextBlock>
					</StackPanel>
				</TabItem.Header>
				<Border Padding="5,20,5,10">
					<Grid Margin="0,0,0,25" RowDefinitions="Auto, *">

						<StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="20">
							<Button Background="LightBlue" Margin="0,10,0,0" Click="SelectAndUploadFilesButton_Click" IsEnabled="{Binding HasSelectedServer}" HorizontalAlignment="Center" ToolTip.Tip="Click to select .ILD files to upload to the device so that they can be played offline.">
								<StackPanel Orientation="Horizontal">
									<materialIcons:MaterialIcon Kind="Upload" VerticalAlignment="Center" Foreground="Black" Height="20" Width="20" HorizontalAlignment="Left"/>
									<TextBlock Text=" Upload .ILD files" VerticalAlignment="Center"></TextBlock>
								</StackPanel>
							</Button>
							<Button Margin="0,10,0,0" Command="{Binding RefreshFileList}" IsEnabled="{Binding HasSelectedServer}" HorizontalAlignment="Center" ToolTip.Tip="Click to refresh the list of .ILD files on the selected device. Programs are searched for both in the device's internal storage, and on any connected USB dongles. You may have to restart the device for new files to be detected.">
								<StackPanel Orientation="Horizontal">
									<materialIcons:MaterialIcon Kind="Refresh" VerticalAlignment="Center" Foreground="Black" Height="20" Width="20" HorizontalAlignment="Left"/>
									<TextBlock Text=" Refresh file list" VerticalAlignment="Center"></TextBlock>
								</StackPanel>
							</Button>
							<TextBlock IsVisible="{Binding HasUploadedFiles}" VerticalAlignment="Center" Foreground="Brown" Text="NB: You may have to restart the device for newly uploaded files to appear. "></TextBlock>
						</StackPanel>

						<Border Grid.Row="1" BorderThickness="1" BorderBrush="DarkGray" MinHeight="368" Margin="0,10,0,0">
							<Grid>
								<ScrollViewer Grid.Row="1" Margin="15,10">
									<ListBox ItemsSource="{Binding Programs}" SelectionMode="Single" SelectedIndex="{Binding SelectedProgramIndex}">
										<ListBox.ItemTemplate>
											<DataTemplate>
												<local:ProgramView Margin="-8,-6,-8,-8"></local:ProgramView>
											</DataTemplate>
										</ListBox.ItemTemplate>
									</ListBox>
								</ScrollViewer>
								<materialIcons:MaterialIcon Kind="Loading" IsVisible="{Binding ProgramListIsRefreshing}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="DarkGray" Height="32" Width="32"/>
							</Grid>
						</Border>

					</Grid>
				</Border>
			</TabItem>

			<!-- SOFTWARE UPDATE -->

			<TabItem FontSize="20">
				<TabItem.Header>
					<StackPanel Orientation="Horizontal">
						<materialIcons:MaterialIcon Kind="Download" VerticalAlignment="Center" Foreground="Gray" Height="25" Width="25" HorizontalAlignment="Left"/>
						<TextBlock Text=" Software update" VerticalAlignment="Center"></TextBlock>
						<TextBlock Text="  New version!" IsVisible="{Binding VersionIsOutdated}" Foreground="Red" VerticalAlignment="Center" FontSize="16"></TextBlock>
					</StackPanel>
				</TabItem.Header>

				<StackPanel Margin="0,30,0,0" Spacing="10">
					<TextBlock Text="Device software" FontWeight="SemiBold" HorizontalAlignment="Center"/>
					<TextBlock Text="{Binding CurrentServerVersion, StringFormat='Current device version: {0}'}"/>
					<TextBlock Text="{Binding NewServerVersion, StringFormat='There is a newer version available: {0} - Please update using step 1 and 2 below.'}" Foreground="Red" IsVisible="{Binding ServerVersionIsOutdated}"/>
					<TextBlock Text="You have the latest version, you do not need to do anything." Foreground="Green" IsVisible="{Binding !ServerVersionIsOutdated}"/>
					<StackPanel Margin="0,10,0,0" Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center">
						<TextBlock Text="Step 1: " VerticalAlignment="Center"/>
						<Button Content="Download latest device software" Background="LightGreen" Command="{Binding DownloadAndSelectNewestServerSoftwareCommand}"/>
						<TextBlock Text="or" VerticalAlignment="Center"></TextBlock>
						<Button Content="Manually select device software" Click="SelectServerSoftwareButton_Click"/>
					</StackPanel>
					<StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center">
						<TextBlock Text="Step 2: " VerticalAlignment="Center"/>
						<Button Command="{Binding UpdateServerSoftwareCommand}" Background="Orange"  HorizontalAlignment="Center" IsEnabled="{Binding HasSelectedServer}">
							<TextBlock Text="{Binding ShortServerSoftwareUpdatePath, StringFormat='Install new device software ({0})'}"></TextBlock>
						</Button>
					</StackPanel>
					<StackPanel Spacing="10" IsVisible="{Binding NeedFullImageReplacementWarning}">
						<StackPanel Margin="0,10,0,0" Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center">
							<materialIcons:MaterialIcon Kind="Warning" VerticalAlignment="Center" Foreground="DarkOrange" Height="25" Width="25" HorizontalAlignment="Left"/>
							<TextBlock MaxWidth="650" Foreground="#BF8000" Text="Warning: Your current device software is so old that updating using this tool may not work! Instead, you must manually write a new firmware image to the micro-SD card in your device. Click the button below, and find the section 'Update firmware using SD card image' for instructions." TextWrapping="Wrap"></TextBlock>
						</StackPanel>
						<Button Command="{Binding OpenManagerDownloadPageCommand}" Background="Orange"  HorizontalAlignment="Center">
							<TextBlock Text="Open micro-SD card firmware update instructions"></TextBlock>
						</Button>
					</StackPanel>

					<TextBlock Text="Manager Tool" FontWeight="SemiBold" HorizontalAlignment="Center" Margin="0,50,0,0"/>
					<TextBlock Text="{Binding CurrentManagerVersion, StringFormat='Current manager tool version: {0}'}"/>
					<TextBlock Text="{Binding NewManagerVersion, StringFormat='There is a newer version available: {0} - Please click the button below and download the newest version.'}" Foreground="Red" IsVisible="{Binding ManagerVersionIsOutdated}"/>
					<TextBlock Text="You have the latest version, you do not need to do anything." Foreground="Green" IsVisible="{Binding !ManagerVersionIsOutdated}"/>
					<StackPanel Margin="0,10,0,0" Orientation="Horizontal" Spacing="20" HorizontalAlignment="Center">
						<Button Content="Go to download site" Background="LightGreen" Command="{Binding OpenManagerDownloadPageCommand}"/>
					</StackPanel>
				</StackPanel>
				
			</TabItem>

			<!-- ADVANCED -->

			<TabItem FontSize="20">
				<TabItem.Header>
					<StackPanel Orientation="Horizontal">
						<materialIcons:MaterialIcon Kind="LightningAlert" VerticalAlignment="Center" Foreground="Gray" Height="25" Width="25" HorizontalAlignment="Left"/>
						<TextBlock Text=" Advanced" VerticalAlignment="Center"></TextBlock>
					</StackPanel>
				</TabItem.Header>

				<Border Padding="5,5,10,10">

					<Grid Margin="0,0,0,5" RowDefinitions="Auto, *, Auto">
						<StackPanel Spacing="10">

							<StackPanel Margin="0, 15, 0, 0" Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="20">
								<Button Click="SelectAndUpdateMcuFirmwareButton_Click" IsEnabled="{Binding HasSelectedServer}" Content=" Update HeliosPRO buffer microcontroller firmware " ToolTip.Tip="In the case that the buffer microcontroller firmware of the HeliosPRO needs to be updated, click here. NB: This shouldn't normally be necessary, don't do this unless you know what you are doing."></Button>
								
								<!--<TextBlock Text="{Binding ShortServerSoftwareUpdatePath, StringFormat='File to install: {0}'}"/>-->
								
							</StackPanel>
							
						</StackPanel>
					</Grid>
				</Border>


			</TabItem>

		</TabControl>
		
		<Grid Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2">
			
		</Grid>
		
	</Grid>

</UserControl>
